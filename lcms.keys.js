(function(){function a(n,t,i){if(n.addEventListener)return n.addEventListener(t,i,!1);n.attachEvent("on"+t,i)}function d(n){return n.type=="keypress"?String.fromCharCode(n.which):i[n.which]?i[n.which]:w[n.which]?w[n.which]:String.fromCharCode(n.which).toLowerCase()}function rt(n){var t=n.target||n.srcElement,i=t.tagName;return(" "+t.className+" ").indexOf(" mousetrap ")>-1?!1:i=="INPUT"||i=="SELECT"||i=="TEXTAREA"||t.contentEditable&&t.contentEditable=="true"}function ut(n,t){return n.sort().join(",")===t.sort().join(",")}function l(n){n=n||{};var i=!1,t;for(t in u){if(n[t]){i=!0;continue}u[t]=0}i||(f=!1)}function nt(n,i,r,f,e){var s,o,c=[];if(!t[n])return[];for(r=="keyup"&&h(n)&&(i=[n]),s=0;s<t[n].length;++s){o=t[n][s];if(o.seq&&u[o.seq]!=o.level)continue;if(r!=o.action)continue;(r=="keypress"||ut(i,o.modifiers))&&(f&&o.combo==e&&t[n].splice(s,1),c.push(o))}return c}function et(n){var t=[];return n.shiftKey&&t.push("shift"),n.altKey&&t.push("alt"),n.ctrlKey&&t.push("ctrl"),n.metaKey&&t.push("meta"),t}function c(n,t){n(t)===!1&&(t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.returnValue=!1,t.cancelBubble=!0)}function ft(n,t){if(rt(t))return;for(var r=nt(n,et(t),t.type),e={},u=!1,i=0;i<r.length;++i){if(r[i].seq){u=!0,e[r[i].seq]=1,c(r[i].callback,t);continue}u||f||c(r[i].callback,t)}t.type!=f||h(n)||l(e)}function s(n){n.which=typeof n.which=="number"?n.which:n.keyCode;var t=d(n);if(!t)return;if(n.type=="keyup"&&v==t){v=!1;return}ft(t,n)}function h(n){return n=="shift"||n=="ctrl"||n=="alt"||n=="meta"}function st(){clearTimeout(g),g=setTimeout(l,1e3)}function ot(){if(!e){e={};for(var n in i){if(n>95&&n<112)continue;i.hasOwnProperty(n)&&(e[i[n]]=n)}}return e}function k(n,t,i){return i||(i=ot()[n]?"keydown":"keypress"),i=="keypress"&&t.length&&(i="keydown"),i}function tt(n,t,i,r){u[n]=0,r||(r=k(t[0],[]));for(var o=function(){f=r,++u[n],st()},s=function(n){c(i,n),r!=="keyup"&&(v=d(n)),setTimeout(l,10)},e=0;e<t.length;++e)b(t[e],e<t.length-1?o:s,r,n,e)}function b(n,i,r,u,f){n=n.replace(/\s+/g," ");var l=n.split(" "),s,e,c,o=[];if(l.length>1)return tt(n,l,i,r);for(c=n==="+"?["+"]:n.split("+"),s=0;s<c.length;++s)e=c[s],p[e]&&(e=p[e]),r&&r!="keypress"&&y[e]&&(e=y[e],o.push("shift")),h(e)&&o.push(e);r=k(e,o,r),t[e]||(t[e]=[]),nt(e,o,r,!u,n),t[e][u?"unshift":"push"]({callback:i,modifiers:o,action:r,seq:u,level:f,combo:n})}function it(n,t,i){for(var r=0;r<n.length;++r)b(n[r],t,i)}for(var i={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},w={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},y={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},p={option:"alt",command:"meta","return":"enter",escape:"esc"},e,t={},r={},u={},g,v=!1,f=!1,o,n=1;n<20;++n)i[111+n]="f"+n;for(n=0;n<=9;++n)i[n+96]=n;a(document,"keypress",s),a(document,"keydown",s),a(document,"keyup",s),o={bind:function(n,t,i){return it(n instanceof Array?n:[n],t,i),r[n+":"+i]=t,this},unbind:function(n,t){return r[n+":"+t]&&(delete r[n+":"+t],this.bind(n,function(){},t)),this},trigger:function(n,t){return r[n+":"+t](),this},reset:function(){return t={},r={},this}},window.LCMSMousetrap=o,typeof define=="function"&&define.amd&&define("mousetrap",function(){return o})})(),(function(n){n(function(){LCMSMousetrap.bind("esc",function(t){var r,i,u;i=function(t,i,r){return n("body").addClass(i).delay(400).queue(function(){return r?window.location.assign(t):window.location.replace(t),n(this).dequeue()})},u=function(n,t){var i,r;t.click?t.click():document.createEvent&&n.target!==t&&(i=document.createEvent("MouseEvents"),i.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),r=t.dispatchEvent(i))};if(n(".suppress-default-esc-action:visible").length)return this;if(n(".lcms-admin-container").length===1){r=n(".lcms-btn.btn-cancel").filter(':contains("Cancel")').last();if(r.length!==1||navigator.userAgent.match(/msie/i))return i("/","lcms-fade",!0);u(t,r)}else return n("body").hasClass("lcms_AdminView")?i(n("#lcms_page_preview a").attr("href"),"lcms-fade",!1):n(".lcms_page_content").length===1?i(n(".lcms_page_content").attr("href"),"lcms-fade",!1):i("/login.aspx?ReturnUrl="+encodeURI(location.pathname),"lcms-explode",!0)},"keyup"),LCMSMousetrap.bind("` esc",function(){window.location.assign("/slogin?ReturnUrl="+encodeURI(location.pathname))},"keyup")})})(LCMS.jq)
